<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <style>
        body { background: #0e0e0e; color: #39ff14; margin: 0; font-family: monospace; overflow: hidden; height: 100vh; display: flex; flex-direction: column; }
        #Header { height: 60px; border-bottom: 2px solid #39ff14; display: flex; align-items: center; justify-content: space-around; background: #111; z-index: 10; }
        .btn { background: #222; color: #39ff14; border: 1px solid #39ff14; padding: 8px; border-radius: 4px; font-weight: bold; font-size: 11px; }
        
        #Workspace { flex-grow: 1; display: flex; justify-content: center; align-items: center; background: #1a1a1a; perspective: 1000px; touch-action: none; }
        #Main_Canvas { background: #fff; box-shadow: 0 0 20px #000; cursor: crosshair; }

        #Mixer_Console { height: 180px; background: #111; border-top: 2px solid #333; padding: 15px; display: flex; flex-direction: column; gap: 12px; }
        .wheel-row { display: flex; align-items: center; justify-content: space-between; gap: 10px; }
        .color-circle { width: 45px; height: 45px; border-radius: 50%; border: 2px solid #fff; overflow: hidden; }
        input[type="color"] { width: 60px; height: 60px; border: none; transform: scale(2); cursor: pointer; }
        #Blend_Result { width: 100%; height: 40px; border: 2px solid #39ff14; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-weight: bold; color: #000; }
        input[type="range"] { flex-grow: 1; }
    </style>
</head>
<body>

    <div id="Header">
        <button class="btn" onclick="snap()">ðŸ§² SNAP 0Â°</button>
        <button class="btn" onclick="alert('L-Vault Active')">[L] VAULT</button>
        <div style="display:flex; flex-direction:column; align-items:center;">
            <span style="font-size:9px;">ROTATION</span>
            <input type="range" min="0" max="360" value="0" oninput="rotateCanvas(this.value)">
        </div>
        <button class="btn" onclick="alert('M-Gateway Active')">[M] GATEWAY</button>
    </div>

    <div id="Workspace">
        <canvas id="Main_Canvas"></canvas>
    </div>

    <div id="Mixer_Console">
        <div class="wheel-row">
            <div class="color-circle"><input type="color" id="wheel1" value="#0000ff" oninput="updateMix()"></div>
            <input type="range" id="mixSlider" min="0" max="100" value="50" oninput="updateMix()">
            <div class="color-circle"><input type="color" id="wheel2" value="#ff00ff" oninput="updateMix()"></div>
        </div>
        <div id="Blend_Result">SE CUSTOM BLEND ACTIVE</div>
        <div class="wheel-row">
            <span style="font-size:10px;">LEAD SIZE:</span>
            <input type="range" id="penSize" min="1" max="50" value="8">
        </div>
    </div>

    <script>
        const canvas = document.getElementById('Main_Canvas');
        const ctx = canvas.getContext('2d');
        let isDrawing = false, angle = 0, mixedHex = "#000";

        // Fit canvas to screen
        canvas.width = window.innerWidth * 0.85;
        canvas.height = window.innerHeight * 0.4;

        function rotateCanvas(v) {
            angle = v;
            canvas.style.transform = `rotate(${v}deg)`;
        }

        function snap() {
            angle = 0;
            canvas.style.transform = 'rotate(0deg)';
        }

        function updateMix() {
            const c1 = document.getElementById('wheel1').value;
            const c2 = document.getElementById('wheel2').value;
            const r = document.getElementById('mixSlider').value / 100;
            
            const rgb1 = [parseInt(c1.substring(1,3),16), parseInt(c1.substring(3,5),16), parseInt(c1.substring(5,7),16)];
            const rgb2 = [parseInt(c2.substring(1,3),16), parseInt(c2.substring(3,5),16), parseInt(c2.substring(5,7),16)];
            const blend = rgb1.map((v, i) => Math.floor(v * (1-r) + rgb2[i] * r));
            
            mixedHex = `rgb(${blend[0]},${blend[1]},${blend[2]})`;
            const resultDiv = document.getElementById('Blend_Result');
            resultDiv.style.background = mixedHex;
            resultDiv.style.color = (blend[0]+blend[1]+blend[2] > 400) ? "#000" : "#fff";
        }

        // SMART DRAWING ENGINE (Calculates rotation)
        function getMousePos(e) {
            const rect = canvas.getBoundingClientRect();
            const clientX = e.touches ? e.touches[0].clientX : e.clientX;
            const clientY = e.touches ? e.touches[0].clientY : e.clientY;
            
            // MATH FOR ROTATED DRAWING
            let x = clientX - (rect.left + rect.width / 2);
            let y = clientY - (rect.top + rect.height / 2);
            let rad = -angle * (Math.PI / 180);
            let newX = x * Math.cos(rad) - y * Math.sin(rad) + canvas.width / 2;
            let newY = x * Math.sin(rad) + y * Math.cos(rad) + canvas.height / 2;
            
            return { x: newX, y: newY };
        }

        function start(e) { isDrawing = true; draw(e); }
        function stop() { isDrawing = false; ctx.beginPath(); }

        function draw(e) {
            if (!isDrawing) return;
            const pos = getMousePos(e);
            ctx.lineWidth = document.getElementById('penSize').value;
            ctx.lineCap = 'round';
            ctx.strokeStyle = mixedHex;
            ctx.lineTo(pos.x, pos.y);
            ctx.stroke();
            ctx.beginPath();
            ctx.moveTo(pos.x, pos.y);
        }

        canvas.addEventListener('mousedown', start);
        canvas.addEventListener('mousemove', draw);
        window.addEventListener('mouseup', stop);
        canvas.addEventListener('touchstart', (e) => { e.preventDefault(); start(e); });
        canvas.addEventListener('touchmove', (e) => { e.preventDefault(); draw(e); });
        canvas.addEventListener('touchend', stop);

        updateMix();
    </script>
</body>
</html>
